/**
 * MorphoNews Feature: 自律的効率バランサー
 * Generated: 2026-01-16_1718
 * Description: ユーザーのスクロール速度と各セクションでの滞在時間をリアルタイム分析し、読解ペースに合わせてコンテンツの表示状態を最適化します。じっくり読んでいる箇所を強調し、速読している箇所を簡略化することで、情報の吸収効率を最大化します。
 */
(function() { const style = document.createElement('style'); style.textContent = '#efficiency-stats { position: fixed; bottom: 10px; left: 10px; background: rgba(15, 15, 15, 0.9); color: #00ffcc; padding: 8px 12px; border-radius: 4px; font-family: "Courier New", monospace; font-size: 11px; z-index: 10000; border: 1px solid #00ffcc; pointer-events: none; transition: opacity 0.3s; } .focus-high { border-left: 3px solid #00ffcc !important; background: rgba(0, 255, 204, 0.05); transition: all 0.4s ease; } .focus-low { opacity: 0.4; filter: blur(0.5px); transition: all 0.4s ease; scale: 0.98; } .focus-label { font-size: 9px; text-transform: uppercase; color: #00ffcc; margin-bottom: 4px; display: block; }'; document.head.appendChild(style); const stats = document.createElement('div'); stats.id = 'efficiency-stats'; document.body.appendChild(stats); const nodeData = new Map(); let lastScroll = window.pageYOffset; let lastTime = Date.now(); const observer = new IntersectionObserver((entries) => { entries.forEach(entry => { const id = entry.target.dataset.mnId || Math.random().toString(36).substr(2, 9); if (!entry.target.dataset.mnId) entry.target.dataset.mnId = id; if (entry.isIntersecting) { nodeData.set(id, { start: Date.now(), total: nodeData.get(id)?.total || 0, hits: (nodeData.get(id)?.hits || 0) + 1 }); } else if (nodeData.has(id)) { const data = nodeData.get(id); data.total += Date.now() - data.start; applyPragmaticUI(entry.target, data); } }); }, { threshold: 0.6 }); function applyPragmaticUI(el, data) { const contentLen = el.innerText.length; const msPerChar = data.total / contentLen; if (msPerChar > 50) { el.classList.add('focus-high'); el.classList.remove('focus-low'); } else if (msPerChar < 5 && data.total > 500) { el.classList.add('focus-low'); el.classList.remove('focus-high'); } } function updateLoop() { const now = Date.now(); const currentScroll = window.pageYOffset; const delta = Math.abs(currentScroll - lastScroll); const timeDelta = now - lastTime; const velocity = timeDelta > 0 ? (delta / timeDelta).toFixed(2) : 0; stats.innerHTML = `<span class="focus-label">Efficiency Monitor</span>SCAN VELOCITY: ${velocity} px/ms<br>NODES TRACKED: ${nodeData.size}<br>MODE: ${velocity > 1.5 ? 'AGILE SCAN' : 'DEEP DIVE'}`; lastScroll = currentScroll; lastTime = now; requestAnimationFrame(updateLoop); } const init = () => { document.querySelectorAll('article, section, p, .news-card').forEach(el => observer.observe(el)); updateLoop(); }; if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', init); } else { init(); } })();
