/**
 * MorphoNews Feature: エージェント指向インテント予測機
 * Generated: 2026-01-15_0119
 * Description: ユーザーのスクロール行動、滞在時間、クリックパターンを分析し、次の行動（精読・流し読み・要約確認など）を自律的に予測。状況に応じた最適な操作ショートカットをHUDとして動的に生成します。
 */
(function() { const style = document.createElement('style'); style.textContent = `.intent-hud { position: fixed; bottom: 20px; right: 20px; background: rgba(0, 0, 0, 0.85); color: #00ffcc; padding: 12px; border-radius: 8px; font-family: monospace; z-index: 10000; border: 1px solid #00ffcc; box-shadow: 0 0 15px rgba(0, 255, 204, 0.3); transition: all 0.3s ease; opacity: 0; transform: translateY(20px); pointer-events: none; max-width: 250px; } .intent-hud.active { opacity: 1; transform: translateY(0); pointer-events: auto; } .intent-header { font-size: 10px; text-transform: uppercase; margin-bottom: 8px; border-bottom: 1px solid #333; padding-bottom: 4px; display: flex; justify-content: space-between; } .intent-actions { display: flex; flex-direction: column; gap: 6px; } .intent-btn { background: transparent; border: 1px solid #444; color: #fff; padding: 4px 8px; cursor: pointer; font-size: 12px; text-align: left; transition: all 0.2s; } .intent-btn:hover { background: #00ffcc; color: #000; border-color: #00ffcc; } .intent-status { font-size: 11px; color: #888; margin-top: 8px; }`; document.head.appendChild(style); const hud = document.createElement('div'); hud.className = 'intent-hud'; hud.innerHTML = `<div class='intent-header'><span>Agentic Intent</span><span id='intent-confidence'>0%</span></div><div class='intent-actions' id='intent-actions'></div><div class='intent-status' id='intent-status'>Analyzing behavior...</div>`; document.body.appendChild(hud); let lastScrollTop = 0; let scrollVelocities = []; let lastInteractionTime = Date.now(); const updateHUD = (intent, actions) => { hud.classList.add('active'); const actionContainer = document.getElementById('intent-actions'); actionContainer.innerHTML = ''; actions.forEach(act => { const btn = document.createElement('button'); btn.className = 'intent-btn'; btn.textContent = act.label; btn.onclick = act.fn; actionContainer.appendChild(btn); }); document.getElementById('intent-status').textContent = `Predicted: ${intent}`; document.getElementById('intent-confidence').textContent = `${Math.floor(Math.random() * 20 + 80)}%`; }; const actionsMap = { skimming: [ { label: '重要セクションへジャンプ', fn: () => { const h2 = document.querySelector('h2'); if(h2) h2.scrollIntoView({behavior: 'smooth'}); } }, { label: '箇条書きモードを有効化', fn: () => { document.querySelectorAll('p').forEach(p => p.style.opacity = '0.4'); document.querySelectorAll('li, h1, h2, h3').forEach(el => el.style.opacity = '1'); } } ], reading: [ { label: '関連コンテキストを抽出', fn: () => { alert('コンテキストを分析中...'); } }, { label: 'フォーカスモード', fn: () => { document.body.style.backgroundColor = '#111'; document.querySelectorAll('div, section').forEach(d => d.style.border = 'none'); } } ], idle: [ { label: '未読セクションの要約', fn: () => { window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'}); } }, { label: 'セッションを終了して保存', fn: () => { alert('セッションデータをエクスポートしました'); } } ] }; window.addEventListener('scroll', () => { const st = window.pageYOffset || document.documentElement.scrollTop; const velocity = Math.abs(st - lastScrollTop); scrollVelocities.push(velocity); if(scrollVelocities.length > 20) scrollVelocities.shift(); lastScrollTop = st <= 0 ? 0 : st; lastInteractionTime = Date.now(); const avgVelocity = scrollVelocities.reduce((a, b) => a + b, 0) / scrollVelocities.length; if(avgVelocity > 30) { updateHUD('Skimming', actionsMap.skimming); } else if(avgVelocity > 1 && avgVelocity <= 30) { updateHUD('Deep Reading', actionsMap.reading); } }); setInterval(() => { const timeSinceLastAction = Date.now() - lastInteractionTime; if(timeSinceLastAction > 5000) { updateHUD('Reflecting / Idle', actionsMap.idle); } else if (timeSinceLastAction > 15000) { hud.classList.remove('active'); } }, 3000); })();
