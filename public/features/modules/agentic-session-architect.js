/**
 * MorphoNews Feature: 自律型セッション・アーキテクト
 * Generated: 2026-01-14_0120
 * Description: ユーザーが設定した読解目標（キーワード）に基づき、ページ内の重要セクションを自律的に抽出し、最短の学習ロードマップを構築するエージェント機能。
 */
(function() { const id = 'agentic-session-architect'; if (document.getElementById(id)) return; const styles = ` #${id} { position: fixed; bottom: 20px; right: 20px; width: 280px; background: #0f172a; color: #38bdf8; border: 1px solid #38bdf8; border-radius: 12px; font-family: 'Segoe UI', system-ui, sans-serif; z-index: 9999; box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3); padding: 15px; font-size: 13px; border-left: 4px solid #38bdf8; transition: all 0.3s ease; } #${id} h3 { margin: 0 0 10px 0; font-size: 14px; font-weight: 800; letter-spacing: 0.05em; color: #f8fafc; display: flex; align-items: center; justify-content: space-between; } #${id} .mission-input { display: flex; gap: 6px; margin-bottom: 12px; } #${id} input { background: #1e293b; border: 1px solid #334155; color: #f8fafc; padding: 6px 10px; border-radius: 6px; flex-grow: 1; outline: none; font-size: 12px; } #${id} input:focus { border-color: #38bdf8; } #${id} button { background: #38bdf8; color: #0f172a; border: none; border-radius: 6px; padding: 6px 12px; cursor: pointer; font-weight: bold; font-size: 11px; white-space: nowrap; } #${id} .roadmap { max-height: 200px; overflow-y: auto; scrollbar-width: thin; } #${id} .checkpoint { padding: 8px; border-radius: 6px; margin-bottom: 6px; background: #1e293b; border: 1px solid transparent; cursor: pointer; transition: 0.2s; position: relative; } #${id} .checkpoint:hover { border-color: #38bdf8; background: #334155; } #${id} .checkpoint.active { border-color: #38bdf8; background: rgba(56, 189, 248, 0.1); } #${id} .checkpoint-tag { font-size: 10px; color: #7dd3fc; margin-bottom: 2px; text-transform: uppercase; font-weight: bold; } #${id} .status-bar { font-size: 11px; color: #94a3b8; margin-top: 10px; padding-top: 8px; border-top: 1px solid #334155; } `; const styleTag = document.createElement('style'); styleTag.textContent = styles; document.head.appendChild(styleTag); const container = document.createElement('div'); container.id = id; container.innerHTML = ` <h3>MISSION ARCHITECT <span style='font-size:10px; opacity:0.6;'>v1.0</span></h3> <div class='mission-input'> <input type='text' id='${id}-input' placeholder='読解目標を入力 (例: AI, 経済, 技術)...'> <button id='${id}-btn'>展開</button> </div> <div id='${id}-roadmap' class='roadmap'></div> <div id='${id}-status' class='status-bar'>待機中: 目標をロードしてください</div> `; document.body.appendChild(container); const input = document.getElementById(`${id}-input`); const btn = document.getElementById(`${id}-btn`); const roadmap = document.getElementById(`${id}-roadmap`); const status = document.getElementById(`${id}-status`); btn.addEventListener('click', () => { const goal = input.value.trim(); if (!goal) return; roadmap.innerHTML = ''; status.textContent = '分析中... ページ構造をスキャンしています'; const targets = Array.from(document.querySelectorAll('h1, h2, h3, p')).filter(el => el.textContent.toLowerCase().includes(goal.toLowerCase()) && el.textContent.length > 10 ); if (targets.length === 0) { status.textContent = '該当するセクションが見つかりませんでした。'; return; } targets.forEach((el, i) => { const checkpoint = document.createElement('div'); checkpoint.className = 'checkpoint'; checkpoint.innerHTML = ` <div class='checkpoint-tag'>STEP ${i + 1}</div> <div>${el.textContent.substring(0, 45).trim()}...</div> `; checkpoint.onclick = () => { el.scrollIntoView({ behavior: 'smooth', block: 'center' }); el.style.backgroundColor = 'rgba(56, 189, 248, 0.2)'; setTimeout(() => el.style.backgroundColor = 'transparent', 2000); document.querySelectorAll('.checkpoint').forEach(c => c.classList.remove('active')); checkpoint.classList.add('active'); status.textContent = `ミッション進行中: ステップ ${i + 1} / ${targets.length}`; }; roadmap.appendChild(checkpoint); }); status.textContent = `${targets.length} 個の重要なチェックポイントを特定しました。`; }); })();
